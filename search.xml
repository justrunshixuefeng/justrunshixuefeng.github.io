<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>*args和**kwargs</title>
      <link href="/2018/08/08/args%E5%92%8C-kwargs/"/>
      <url>/2018/08/08/args%E5%92%8C-kwargs/</url>
      
        <content type="html"><![CDATA[<h4 id="args-kwargs-不定长参数"><a href="#args-kwargs-不定长参数" class="headerlink" title="args  *kwargs  不定长参数"></a><em>args  *</em>kwargs  不定长参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">jia</span><span class="params">(*args)</span>:</span></span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> args:</span><br><span class="line">        s += i</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(jia(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>))         <span class="comment">#6</span></span><br></pre></td></tr></table></figure><a id="more"></a><blockquote><p>python函数允许同时全部或部分使用使用固定参数，默认参数，单值（一颗星）可变参数，键值对（两颗星）可变参数，使用时必须安装前述顺序书写。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">info</span><span class="params">(name, age=<span class="number">18</span>, *args, **kwargs)</span>:</span></span><br><span class="line">    print(<span class="string">'姓名:%s,年龄:%d'</span> % (name, age))</span><br><span class="line">    print(args)</span><br><span class="line">    print(kwargs)</span><br><span class="line"></span><br><span class="line">info(<span class="string">'xuefeng'</span>, <span class="number">23</span>, <span class="number">180</span>, <span class="number">80</span>, like=<span class="string">'python'</span>, body=<span class="string">'fat'</span>)</span><br></pre></td></tr></table></figure><p><img src="/2018/08/08/args和-kwargs/1.png" alt="img"></p><blockquote><p>此外一颗星（单值可变参数）和两颗星（键值对可变参数）还可用于列表，元组，字典的解包。</p></blockquote><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">print(*a)               <span class="comment"># 1 2 3</span></span><br><span class="line">b = (<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">print(*b)               <span class="comment"># 1 2 3</span></span><br><span class="line">c = &#123;<span class="string">'name'</span>: <span class="string">'小明'</span>, <span class="string">'age'</span>: <span class="number">23</span>&#125;</span><br><span class="line">print(*c)               <span class="comment"># name age</span></span><br><span class="line">print(<span class="string">'name:&#123;name&#125;,age:&#123;age&#125;'</span>.format(**c))  <span class="comment"># name:小明,age:23</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>find</title>
      <link href="/2018/08/08/find/"/>
      <url>/2018/08/08/find/</url>
      
        <content type="html"><![CDATA[<h3 id="find命令格式："><a href="#find命令格式：" class="headerlink" title="find命令格式："></a>find命令格式：</h3><p>find   path  -option  【 -print 】  【 -exec   -ok   |xargs  |grep  】 【  command  {} ;  】</p><a id="more"></a><hr><p>find命令的参数：</p><ol><li><p>path：要查找的目录路径。 </p><blockquote><p>  ~ 表示$HOME目录<br>  . 表示当前目录<br>  / 表示根目录 </p></blockquote></li><li><p>print：表示将结果输出到标准输出。</p></li><li><p>exec：对匹配的文件执行该参数所给出的shell命令。 </p><pre><code>形式为command {} \;，注意{}与\;之间有空格 </code></pre></li><li><p>ok：与exec作用相同，</p><pre><code>区别在于，在执行命令之前，都会给出提示，让用户确认是否执行 </code></pre></li><li><p>|xargs  与exec作用相同 ，起承接作用</p><p>区别在于 |xargs 主要用于承接删除操作 ，而 -exec 都可用 如复制、移动、重命名等</p></li><li><p>options ：表示查找方式</p><blockquote><p>options常用的有下选项：</p><p>-name   filename               #查找名为filename的文件<br>-perm                                #按执行权限来查找<br>-user    username             #按文件属主来查找<br>-group groupname            #按组来查找<br>-mtime   -n +n                   #按文件更改时间来查找文件，-n指n天以内，+n指n天以前<br>-atime    -n +n                   #按文件访问时间来查找文件，-n指n天以内，+n指n天以前<br>-ctime    -n +n                  #按文件创建时间来查找文件，-n指n天以内，+n指n天以前<br>-nogroup                          #查无有效属组的文件，即文件的属组在/etc/groups中不存在<br>-nouser                            #查无有效属主的文件，即文件的属主在/etc/passwd中不存<br>-type    b/d/c/p/l/f             #查是块设备、目录、字符设备、管道、符号链接、普通文件<br>-size      n[c]                    #查长度为n块[或n字节]的文件<br>-mount                            #查文件时不跨越文件系统mount点<br>-follow                            #如果遇到符号链接文件，就跟踪链接所指的文件<br>-prune                            #忽略某个目录</p></blockquote></li></ol><hr><p>下面通过一些简单的例子来介绍下find的常规用法： </p><h4 id="1、按名字查找"><a href="#1、按名字查找" class="headerlink" title="1、按名字查找"></a>1、按名字查找</h4><pre><code>在当前目录及子目录中，查找大写字母开头的txt文件  $ find . -name &apos;[A-Z]*.txt&apos; -print 　　在/etc及其子目录中，查找host开头的文件 $ find /etc -name &apos;host*&apos; -print 　　在$HOME目录及其子目录中，查找所有文件 　　$ find ~ -name &apos;*&apos; -print 在当前目录及子目录中，查找不是out开头的txt文件 　　$ find . -name &quot;out*&quot; -prune -o -name &quot;*.txt&quot; -print </code></pre><h4 id="2、按目录查找"><a href="#2、按目录查找" class="headerlink" title="2、按目录查找 　　"></a>2、按目录查找 　　</h4><pre><code>在当前目录除aa之外的子目录内搜索 txt文件 　　$ find . -path &quot;./aa&quot; -prune -o -name &quot;*.txt&quot; -print 　　在当前目录及除aa和bb之外的子目录中查找txt文件 　　$ find . −path′./dir0′−o−path′./dir1′−path′./dir0′−o−path′./dir1′ -a -prune -o -name &apos;*.txt&apos; -print</code></pre><p>注意：在1、2处都需要加空格，否则会出现如图所示的报错</p><pre><code>      在3处加不加 -a都可以 在当前目录，不再子目录中，查找txt文件  $ find . ! -name &quot;.&quot; -type d -prune -o -type f -name &quot;*.txt&quot; -print 或者   find . -name *.txt -type f -print</code></pre><p>友情链接：Linux中find命令-path -prune用法详解</p><h4 id="3、按权限查找"><a href="#3、按权限查找" class="headerlink" title="3、按权限查找 　　"></a>3、按权限查找 　　</h4><p>​      </p><pre><code>在当前目录及子目录中，查找属主具有读写执行，其他具有读执行权限的文件 　　$ find . -perm 755 -print 查找用户有写权限或者组用户有写权限的文件或目录find ./ -perm /220find ./ -perm /u+w,g+wfind ./ -perm /u=w,g=w</code></pre><h4 id="4、按类型查找-（b-d-c-p-l-f-）"><a href="#4、按类型查找-（b-d-c-p-l-f-）" class="headerlink" title="4、按类型查找 　（b/d/c/p/l/f ）　"></a>4、按类型查找 　（b/d/c/p/l/f ）　</h4><pre><code>在当前目录及子目录下，查找符号链接文件 　　$ find . -type l -print </code></pre><h4 id="5、按属主及属组"><a href="#5、按属主及属组" class="headerlink" title="5、按属主及属组 　　"></a>5、按属主及属组 　　</h4><pre><code>查找属主是www的文件 　　$ find / -user www -type f -print 　　查找属主被删除的文件 $ find / -nouser -type f -print 　　查找属组 mysql 的文件 $ find / -group mysql -type f -print 　　查找用户组被删掉的文件 $ find / -nogroup -type f -print </code></pre><h4 id="6、按时间查找"><a href="#6、按时间查找" class="headerlink" title="6、按时间查找 　　"></a>6、按时间查找 　　</h4><pre><code>查找2天内被更改过的文件  $ find . -mtime -2 -type f -print 　　查找2天前被更改过的文件 $ find . -mtime +2 -type f -print 　　查找一天内被访问的文件 $ find . -atime -1 -type f -print 　　查找一天前被访问的文件 $ find . -atime +1 -type f -print 　　查找一天内状态被改变的文件 $ find . -ctime -1 -type f -print 　　查找一天前状态被改变的文件 $ find . -ctime +1 -type f -print 　　查找10分钟以前状态被改变的文件 $ find . -cmin +10 -type f -print </code></pre><h4 id="7、按文件新旧"><a href="#7、按文件新旧" class="headerlink" title="7、按文件新旧 　　"></a>7、按文件新旧 　　</h4><p>​      </p><pre><code>查找比 aa.txt 新的文件 $ find . -newer &quot;aa.txt&quot; -type f -print 　　查找比 aa.txt 旧的文件 $ find . ! -newer &quot;aa.txt&quot; -type f -print 　　查找比aa.txt新，比bb.txt旧的文件 $ find . -newer &apos;aa.txt&apos; ! -newer &apos;bb.txt&apos; -type f -print </code></pre><h4 id="8、按大小查找"><a href="#8、按大小查找" class="headerlink" title="8、按大小查找 　　"></a>8、按大小查找 　　</h4><pre><code>查找超过1M的文件 $ find / -size +1M -type f -print 　　查找等于6字节的文件 $ find . -size 6c -print 　　查找小于32k的文件 $ find . -size -32k -print </code></pre><h4 id="9、执行命令"><a href="#9、执行命令" class="headerlink" title="9、执行命令 　　"></a>9、执行命令 　　</h4><p>​      </p><pre><code>  1）查找 del.txt 并删除，删除前提示确认   $ find . -name &apos;del.txt&apos; -ok rm {} \; 　　 2） 查找 aa.txt 并备份为aa.txt.bak   $ find . -name &apos;aa.txt&apos; -exec cp {} {}.bak \; 3）查当前目录下的所有普通文件# find . -type f -exec ls -l {} \; </code></pre><p>   -rw-r–r–    1 root      root         34928 2003-02-25   ./conf/httpd.conf<br>   -rw-r–r–    1 root      root         12959 2003-02-25   ./conf/magic<br>   -rw-r–r–    1 root      root          180 2003-02-25   ./conf.d/README </p><p>   查当前目录下的所有普通文件，并在 - exec 选项中使用 ls -l 命令将它们列出</p><p>   4）在 /logs 目录中查找更改时间在5日以前的文件并删除它们<br>   $ find logs -type f -mtime +5 -exec   -ok   rm {} ;</p><p>   5）查询当天修改过的文件</p><p>   $ find  ./  -mtime  -1  -type f  -exec  ls -l  {} ; </p><p>   6）查询文件并询问是否要显示</p><pre><code># find   ./   -mtime   -1   -type f   -ok   ls -l   {} \;  &lt; ls … ./classDB.inc.php &gt; ? y-rw-r–r–    1 cnscn    cnscn       13709   1月 12 12:22 ./classDB.inc.php# find   ./   -mtime   -1   -type f   -ok   ls -l   {} \;  &lt; ls … ./classDB.inc.php &gt; ? n</code></pre><p>关于 有没有 -print 的区别</p><h5 id="加-print"><a href="#加-print" class="headerlink" title="加  -print"></a>加  -print</h5><p>查找目录并列出目录下的文件(为找到的每一个目录单独执行ls命令，没有选项-print时文件列表前一行不会显示目录名称)<br>find . -type d -print -exec ls {} ;</p><p><img src="/2018/08/08/find/C:%5CUsers%5Clenovo%5Cblog%5Csource_posts%5Cfind%5C1.png" alt="img"></p><h5 id="不加-print"><a href="#不加-print" class="headerlink" title="不加 -print"></a>不加 -print</h5><p><img src="/2018/08/08/find/find%5C2.png" alt="img"></p><hr><p>原文链接：<a href="https://blog.csdn.net/l_liangkk/article/details/81294260" target="_blank" rel="noopener">https://blog.csdn.net/l_liangkk/article/details/81294260</a></p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>python语法：for...else...</title>
      <link href="/2018/08/08/python%E8%AF%AD%E6%B3%95%EF%BC%9Afor-else/"/>
      <url>/2018/08/08/python%E8%AF%AD%E6%B3%95%EF%BC%9Afor-else/</url>
      
        <content type="html"><![CDATA[<h2 id="了解for-和-else-语法"><a href="#了解for-和-else-语法" class="headerlink" title="了解for 和 else 语法"></a>了解for 和 else 语法</h2><blockquote><p> 只要for循环完毕，else就会跑一遍。循环被break中段，则不会走else</p></blockquote><h4 id="当for循环能够顺利循环完毕，则最后输出else-并且else能够打印最后一次的输出"><a href="#当for循环能够顺利循环完毕，则最后输出else-并且else能够打印最后一次的输出" class="headerlink" title="当for循环能够顺利循环完毕，则最后输出else,并且else能够打印最后一次的输出"></a>当for循环能够顺利循环完毕，则最后输出else,并且else能够打印最后一次的输出</h4><a id="more"></a><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line"></span><br><span class="line">  print(i)</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  print(i, <span class="string">'我是else'</span>)  <span class="comment"># 可以打印</span></span><br></pre></td></tr></table></figure><p><img src="/2018/08/08/python语法：for-else/1.png" alt="img"></p><h4 id="当for-循环被break时，就不会走到else了"><a href="#当for-循环被break时，就不会走到else了" class="headerlink" title="当for 循环被break时，就不会走到else了"></a>当for 循环被break时，就不会走到else了</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> i &gt; <span class="number">2</span>:</span><br><span class="line"></span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  print(i, <span class="string">'我是else'</span>)<span class="comment"># 打印不出来</span></span><br></pre></td></tr></table></figure><p><img src="/2018/08/08/python语法：for-else/2.png" alt="img"></p><h4 id="continue-不会妨碍else"><a href="#continue-不会妨碍else" class="headerlink" title="continue 不会妨碍else"></a>continue 不会妨碍else</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">5</span>):</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> i &gt; <span class="number">2</span>:</span><br><span class="line"></span><br><span class="line">    print(i)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line"></span><br><span class="line">  print(i, <span class="string">'我是else'</span>)<span class="comment"># 可以打印</span></span><br></pre></td></tr></table></figure><p><img src="/2018/08/08/python语法：for-else/3.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> python语法 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> python语法 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>grep</title>
      <link href="/2018/08/08/grep/"/>
      <url>/2018/08/08/grep/</url>
      
        <content type="html"><![CDATA[<h2 id="前言：grep这个命令都不陌生，最常用的就是和管道符结合，例如：ps-ef-grep-docker。"><a href="#前言：grep这个命令都不陌生，最常用的就是和管道符结合，例如：ps-ef-grep-docker。" class="headerlink" title="前言：grep这个命令都不陌生，最常用的就是和管道符结合，例如：ps -ef | grep docker。"></a>前言：grep这个命令都不陌生，最常用的就是和管道符结合，例如：ps -ef | grep docker。</h2><p>Grep称为全局正则表达式检索工具，在企业中被广泛的采用。</p><a id="more"></a><h2 id="grep的语法格式："><a href="#grep的语法格式：" class="headerlink" title="grep的语法格式："></a>grep的语法格式：</h2><p>grep  -option（参数） ‘word’（关键词） file（文本文件）；</p><h2 id="grep参数："><a href="#grep参数：" class="headerlink" title="grep参数："></a>grep参数：</h2><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">-a 不要忽略二进制数据。</span></span><br><span class="line"><span class="deletion">-A&lt;显示列数&gt; 除了显示符合范本样式的那一行之外，并显示该行之后的内容。</span></span><br><span class="line"><span class="deletion">-b 在显示符合范本样式的那一行之外，并显示该行之前的内容。</span></span><br><span class="line"><span class="deletion">-c 计算符合范本样式的列数。</span></span><br><span class="line"><span class="deletion">-C&lt;显示列数&gt;或-&lt;显示列数&gt;  除了显示符合范本样式的那一列之外，并显示该列之前后的内容。</span></span><br><span class="line"><span class="deletion">-d&lt;进行动作&gt; 当指定要查找的是目录而非文件时，必须使用这项参数，否则grep命令将回报信息并停止动作。</span></span><br><span class="line"><span class="deletion">-e&lt;范本样式&gt; 指定字符串作为查找文件内容的范本样式。</span></span><br><span class="line"><span class="deletion">-E 将范本样式为延伸的普通表示法来使用，意味着使用能使用扩展正则表达式。</span></span><br><span class="line"><span class="deletion">-f&lt;范本文件&gt; 指定范本文件，其内容有一个或多个范本样式，让grep查找符合范本条件的文件内容，格式为每一列的范本样式。</span></span><br><span class="line"><span class="deletion">-F 将范本样式视为固定字符串的列表。</span></span><br><span class="line"><span class="deletion">-G 将范本样式视为普通的表示法来使用。</span></span><br><span class="line"><span class="deletion">-h 在显示符合范本样式的那一列之前，不标示该列所属的文件名称。</span></span><br><span class="line"><span class="deletion">-H 在显示符合范本样式的那一列之前，标示该列的文件名称。</span></span><br><span class="line"><span class="deletion">-i 忽略字符大小写的差别。</span></span><br><span class="line"><span class="deletion">-l 列出文件内容符合指定的范本样式的文件名称。</span></span><br><span class="line"><span class="deletion">-L 列出文件内容不符合指定的范本样式的文件名称。</span></span><br><span class="line"><span class="deletion">-n 在显示符合范本样式的那一列之前，标示出该列的编号。</span></span><br><span class="line"><span class="deletion">-q 不显示任何信息。</span></span><br><span class="line"><span class="deletion">-R/-r 此参数的效果和指定“-d recurse”参数相同。</span></span><br><span class="line"><span class="deletion">-s 不显示错误信息。</span></span><br><span class="line"><span class="deletion">-v 反转查找。</span></span><br><span class="line"><span class="deletion">-w 只显示全字符合的列。</span></span><br><span class="line"><span class="deletion">-x 只显示全列符合的列。</span></span><br><span class="line"><span class="deletion">-y 此参数效果跟“-i”相同。</span></span><br><span class="line"><span class="deletion">-o 只输出文件中匹配到的部分。</span></span><br></pre></td></tr></table></figure><h2 id="grep常见用法："><a href="#grep常见用法：" class="headerlink" title="grep常见用法："></a>grep常见用法：</h2><h3 id="1-查找-etc-passwd文件中是否存在quail用户信息"><a href="#1-查找-etc-passwd文件中是否存在quail用户信息" class="headerlink" title="1.查找/etc/passwd文件中是否存在quail用户信息"></a>1.查找/etc/passwd文件中是否存在quail用户信息</h3><figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="variable">@www</span> sed]<span class="comment"># grep "quail" /etc/passwd</span></span><br><span class="line"><span class="symbol">quail:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:quail</span><span class="symbol">:/home/quail</span><span class="symbol">:/bin/bash</span></span><br><span class="line">[root<span class="variable">@www</span> sed]<span class="comment"># grep -w "quail" /etc/passwd</span></span><br><span class="line"><span class="symbol">quail:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:quail</span><span class="symbol">:/home/quail</span><span class="symbol">:/bin/bash</span></span><br><span class="line">[root<span class="variable">@www</span> sed]<span class="comment"># grep -i quail /etc/passwd</span></span><br><span class="line"><span class="symbol">quail:</span><span class="symbol">x:</span><span class="number">1000</span><span class="symbol">:</span><span class="number">1000</span><span class="symbol">:quail</span><span class="symbol">:/home/quail</span><span class="symbol">:/bin/bash</span></span><br></pre></td></tr></table></figure><h3 id="2-ifconfig看到网卡信息，只查看IP地址所在行信息"><a href="#2-ifconfig看到网卡信息，只查看IP地址所在行信息" class="headerlink" title="2.ifconfig看到网卡信息，只查看IP地址所在行信息"></a>2.ifconfig看到网卡信息，只查看IP地址所在行信息</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# ifconfig |grep -w inet</span><br><span class="line">        inet <span class="number">192.168</span><span class="number">.249</span><span class="number">.132</span>  netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>  broadcast <span class="number">192.168</span><span class="number">.249</span><span class="number">.255</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">[root@www sed]# ifconfig |grep netmask</span><br><span class="line">        inet <span class="number">192.168</span><span class="number">.249</span><span class="number">.132</span>  netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>  broadcast <span class="number">192.168</span><span class="number">.249</span><span class="number">.255</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">[root@www sed]# ifconfig |grep -w <span class="number">255</span></span><br><span class="line">        inet <span class="number">192.168</span><span class="number">.249</span><span class="number">.132</span>  netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>  broadcast <span class="number">192.168</span><span class="number">.249</span><span class="number">.255</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">[root@www sed]# ifconfig |grep -E <span class="string">"192|127"</span></span><br><span class="line">        inet <span class="number">192.168</span><span class="number">.249</span><span class="number">.132</span>  netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>  broadcast <span class="number">192.168</span><span class="number">.249</span><span class="number">.255</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br><span class="line">[root@www sed]# ifconfig |grep -E <span class="string">"([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"</span></span><br><span class="line">        inet <span class="number">192.168</span><span class="number">.249</span><span class="number">.132</span>  netmask <span class="number">255.255</span><span class="number">.255</span><span class="number">.0</span>  broadcast <span class="number">192.168</span><span class="number">.249</span><span class="number">.255</span></span><br><span class="line">        inet <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>  netmask <span class="number">255.0</span><span class="number">.0</span><span class="number">.0</span></span><br></pre></td></tr></table></figure><h4 id="实验需要，新建list-txt并写入如下内容："><a href="#实验需要，新建list-txt并写入如下内容：" class="headerlink" title="实验需要，新建list.txt并写入如下内容："></a>实验需要，新建list.txt并写入如下内容：</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# cat <span class="type">list</span>.txt </span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.2</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.4</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.5</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">172.0</span><span class="number">.0</span><span class="number">.1</span> www <span class="number">123456</span></span><br><span class="line"><span class="number">1111.222</span><span class="number">.111</span><span class="number">.111</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">111.22</span><span class="number">.11</span><span class="number">.1111</span> root <span class="number">123456</span></span><br></pre></td></tr></table></figure><h3 id="3-统计root-字符总行数"><a href="#3-统计root-字符总行数" class="headerlink" title="3.统计root 字符总行数"></a>3.统计root 字符总行数</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@www</span> sed]<span class="meta"># grep -c root list.txt </span></span><br><span class="line"><span class="number">7</span></span><br></pre></td></tr></table></figure><h3 id="4-不区分大小写查找RoOt所有行"><a href="#4-不区分大小写查找RoOt所有行" class="headerlink" title="4.不区分大小写查找RoOt所有行"></a>4.不区分大小写查找RoOt所有行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep -i RoOt <span class="type">list</span>.txt </span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.2</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.4</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.5</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">1111.222</span><span class="number">.111</span><span class="number">.111</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">111.22</span><span class="number">.11</span><span class="number">.1111</span> root <span class="number">123456</span></span><br></pre></td></tr></table></figure><h3 id="5-打印www行以及行号"><a href="#5-打印www行以及行号" class="headerlink" title="5.打印www行以及行号"></a>5.打印www行以及行号</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@www sed]</span># <span class="selector-tag">grep</span> <span class="selector-tag">-n</span> <span class="selector-tag">www</span> <span class="selector-tag">list</span><span class="selector-class">.txt</span> </span><br><span class="line">6<span class="selector-pseudo">:172.0.0.1</span> <span class="selector-tag">www</span> 123456</span><br></pre></td></tr></table></figure><h3 id="6-不打印root行"><a href="#6-不打印root行" class="headerlink" title="6.不打印root行"></a>6.不打印root行</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@www sed]</span># <span class="selector-tag">grep</span> <span class="selector-tag">-v</span> <span class="selector-tag">root</span> <span class="selector-tag">list</span><span class="selector-class">.txt</span> </span><br><span class="line">172<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span> <span class="selector-tag">www</span> 123456</span><br></pre></td></tr></table></figure><h3 id="7-以168-开头的接3-5的行"><a href="#7-以168-开头的接3-5的行" class="headerlink" title="7.以168.开头的接3 5的行"></a>7.以168.开头的接3 5的行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep <span class="string">"168.[35]"</span> <span class="type">list</span>.txt </span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.5</span><span class="number">.11</span> root <span class="number">123456</span></span><br></pre></td></tr></table></figure><h3 id="8-显示输出行首不是192的行"><a href="#8-显示输出行首不是192的行" class="headerlink" title="8.显示输出行首不是192的行"></a>8.显示输出行首不是192的行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep -E -v  <span class="string">"^192"</span> <span class="type">list</span>.txt </span><br><span class="line"><span class="number">172.0</span><span class="number">.0</span><span class="number">.1</span> www <span class="number">123456</span></span><br><span class="line"><span class="number">1111.222</span><span class="number">.111</span><span class="number">.111</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">111.22</span><span class="number">.11</span><span class="number">.1111</span> root <span class="number">123456</span></span><br></pre></td></tr></table></figure><h3 id="9-匹配R或r开头的行-提前echo-“root-123-nRoot-123”-gt-list-txt"><a href="#9-匹配R或r开头的行-提前echo-“root-123-nRoot-123”-gt-list-txt" class="headerlink" title="9.匹配R或r开头的行,提前echo “root 123\nRoot 123” &gt; list.txt"></a>9.匹配R或r开头的行,提前echo “root 123\nRoot 123” &gt; list.txt</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep -E <span class="string">"^[Rr]oot"</span> <span class="type">list</span>.txt </span><br><span class="line">root <span class="number">1234</span> <span class="number">2134</span> <span class="number">123</span></span><br><span class="line">Root <span class="number">123</span> <span class="number">123</span> <span class="number">123</span> <span class="number">786</span></span><br></pre></td></tr></table></figure><h3 id="10-匹配r，两个任意字符，紧接t的行"><a href="#10-匹配r，两个任意字符，紧接t的行" class="headerlink" title="10.匹配r，两个任意字符，紧接t的行"></a>10.匹配r，两个任意字符，紧接t的行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep <span class="string">"r..t"</span> <span class="type">list</span>.txt </span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.2</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.4</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.5</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">1111.222</span><span class="number">.111</span><span class="number">.111</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">111.22</span><span class="number">.11</span><span class="number">.1111</span> root <span class="number">123456</span></span><br><span class="line">root <span class="number">1234</span> <span class="number">2134</span> <span class="number">123</span></span><br></pre></td></tr></table></figure><h3 id="11-匹配字母紧跟w-的行"><a href="#11-匹配字母紧跟w-的行" class="headerlink" title="11.匹配字母紧跟w 的行"></a>11.匹配字母紧跟w 的行</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-attr">[root@www sed]</span># <span class="selector-tag">grep</span> <span class="selector-tag">-E</span> "<span class="selector-attr">[a-Z]</span><span class="selector-tag">w</span> " <span class="selector-tag">list</span><span class="selector-class">.txt</span> </span><br><span class="line">172<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span> <span class="selector-tag">www</span> 123456</span><br></pre></td></tr></table></figure><h3 id="12-打印字符w字符连续出现2次以上的行"><a href="#12-打印字符w字符连续出现2次以上的行" class="headerlink" title="12.打印字符w字符连续出现2次以上的行"></a>12.打印字符w字符连续出现2次以上的行</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep <span class="string">"w\&#123;2,\&#125;"</span> <span class="type">list</span>.txt </span><br><span class="line"><span class="number">172.0</span><span class="number">.0</span><span class="number">.1</span> www <span class="number">123456</span></span><br></pre></td></tr></table></figure><h3 id="13-打印字符o连续出现3次和5次的行"><a href="#13-打印字符o连续出现3次和5次的行" class="headerlink" title="13.打印字符o连续出现3次和5次的行"></a>13.打印字符o连续出现3次和5次的行</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root<span class="symbol">@www</span> sed]<span class="meta"># grep <span class="string">"o\&#123;3,5\&#125;"</span> list.txt </span></span><br><span class="line">rooot</span><br><span class="line">rooooot</span><br></pre></td></tr></table></figure><h3 id="14-打印-usr-local-nginx-conf-nginx-conf-default空行的所在的行号"><a href="#14-打印-usr-local-nginx-conf-nginx-conf-default空行的所在的行号" class="headerlink" title="14.打印/usr/local/nginx/conf/nginx.conf.default空行的所在的行号"></a>14.打印/usr/local/nginx/conf/nginx.conf.default空行的所在的行号</h3><figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]<span class="comment"># grep -n "^$" /usr/local/nginx/conf/nginx.conf.default </span></span><br><span class="line"><span class="section">1:</span></span><br><span class="line"><span class="section">4:</span></span><br><span class="line"><span class="section">8:</span></span><br><span class="line"><span class="section">10:</span></span><br><span class="line"><span class="section">11:</span></span><br><span class="line"><span class="section">15:</span></span><br><span class="line"><span class="section">16:</span></span><br><span class="line"><span class="section">20:</span></span><br><span class="line"><span class="section">24:</span></span><br><span class="line"><span class="section">26:</span></span><br><span class="line"><span class="section">29:</span></span><br><span class="line"><span class="section">32:</span></span><br><span class="line"><span class="section">34:</span></span><br><span class="line"><span class="section">38:</span></span><br><span class="line"><span class="section">40:</span></span><br><span class="line"><span class="section">42:</span></span><br><span class="line"><span class="section">47:</span></span><br><span class="line"><span class="section">49:</span></span><br><span class="line"><span class="section">56:</span></span><br><span class="line"><span class="section">62:</span></span><br><span class="line"><span class="section">72:</span></span><br><span class="line"><span class="section">80:</span></span><br><span class="line"><span class="section">81:</span></span><br><span class="line"><span class="section">88:</span></span><br><span class="line"><span class="section">94:</span></span><br><span class="line"><span class="section">95:</span></span><br><span class="line"><span class="section">101:</span></span><br><span class="line"><span class="section">104:</span></span><br><span class="line"><span class="section">107:</span></span><br><span class="line"><span class="section">110:</span></span><br><span class="line"><span class="section">116:</span></span><br></pre></td></tr></table></figure><h3 id="15-过滤-usr-local-nginx-conf-nginx-conf-default文件中的-和空行以及行号"><a href="#15-过滤-usr-local-nginx-conf-nginx-conf-default文件中的-和空行以及行号" class="headerlink" title="15.过滤/usr/local/nginx/conf/nginx.conf.default文件中的#和空行以及行号"></a>15.过滤/usr/local/nginx/conf/nginx.conf.default文件中的#和空行以及行号</h3><p>[root@www sed]# grep -E -v -n “#|^$” /usr/local/nginx/conf/nginx.conf.default<br>3:worker_processes 1;<br>12:events {<br>13: worker_connections 1024;<br>14:}<br>17:http {<br>18: include mime.types;<br>19: default_type application/octet-stream;<br>27: sendfile on;<br>31: keepalive_timeout 65;<br>35: server {<br>36: listen 80;<br>37: server_name localhost;<br>43: location / {<br>44: root html;<br>45: index index.html index.htm;<br>46: }<br>52: error_page 500 502 503 504 /50x.html;<br>53: location = /50x.html {<br>54: root html;<br>55: }<br>79: }<br>117:}</p><h3 id="16-当前目录下文件内匹配包含quail或test或anchun的文件"><a href="#16-当前目录下文件内匹配包含quail或test或anchun的文件" class="headerlink" title="16.当前目录下文件内匹配包含quail或test或anchun的文件"></a>16.当前目录下文件内匹配包含quail或test或anchun的文件</h3><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">`seq 1 3`</span>;<span class="keyword">do</span> echo quail$i &gt; test$i.txt ;done</span><br><span class="line">[root@www sed]# <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">`seq 1 3`</span>;<span class="keyword">do</span> echo test$i &gt; yoyoyo$i.txt ;done</span><br><span class="line">[root@www sed]# <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">`seq 1 3`</span>;<span class="keyword">do</span> echo anchun$i &gt; lalal$i.txt ;done</span><br><span class="line">[root@www sed]# <span class="keyword">for</span> i <span class="keyword">in</span> <span class="string">`seq 1 3`</span>;<span class="keyword">do</span> echo <span class="keyword">error</span>$i &gt; yingyingying$i.txt ;done ######实验环境######</span><br></pre></td></tr></table></figure><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# <span class="keyword">grep</span> -E -ra <span class="string">"quail|test|anchun"</span> *</span><br><span class="line">lalal1.tx<span class="variable">t:anchun1</span></span><br><span class="line">lalal2.tx<span class="variable">t:anchun2</span></span><br><span class="line">lalal3.tx<span class="variable">t:anchun3</span></span><br><span class="line">test1.tx<span class="variable">t:quail1</span></span><br><span class="line">test2.tx<span class="variable">t:quail2</span></span><br><span class="line">test3.tx<span class="variable">t:quail3</span></span><br><span class="line">yoyoyo1.tx<span class="variable">t:test1</span></span><br><span class="line">yoyoyo2.tx<span class="variable">t:test2</span></span><br><span class="line">yoyoyo3.tx<span class="variable">t:test3</span></span><br></pre></td></tr></table></figure><h3 id="17-匹配IPV4地址"><a href="#17-匹配IPV4地址" class="headerlink" title="17.匹配IPV4地址"></a>17.匹配IPV4地址</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@www sed]# grep -E -w --color <span class="string">"([0-9]&#123;1,3&#125;\.)&#123;3&#125;[0-9]&#123;1,3&#125;"</span> <span class="type">list</span>.txt </span><br><span class="line"><span class="number">192.168</span><span class="number">.1</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.2</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.3</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.4</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">192.168</span><span class="number">.5</span><span class="number">.11</span> root <span class="number">123456</span></span><br><span class="line"><span class="number">172.0</span><span class="number">.0</span><span class="number">.1</span> www <span class="number">123456</span></span><br></pre></td></tr></table></figure><hr><p>原文链接： <a href="https://www.cnblogs.com/quail2333/p/11179106.html" target="_blank" rel="noopener">https://www.cnblogs.com/quail2333/p/11179106.html</a> </p>]]></content>
      
      
      <categories>
          
          <category> linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Django-DBrouter</title>
      <link href="/2018/08/08/Django-DBrouter/"/>
      <url>/2018/08/08/Django-DBrouter/</url>
      
        <content type="html"><![CDATA[<h2 id="DB-router"><a href="#DB-router" class="headerlink" title="DB-router"></a>DB-router</h2><blockquote><p>通过编写<strong>db-router</strong>可以灵性连接<strong>mysql</strong>主从复制等情况下的多数据库</p></blockquote><ul><li>假设你已经配置好了类似<strong>MYSQL</strong>主从复制的服务，如果没有可以参照<a href="https://lienze.tech/blog/mysql/c813917a.html" target="_blank" rel="noopener">这里</a></li></ul><a id="more"></a><ul><li>settings.py</li></ul><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DATABASES = &#123;    'default': &#123;        'ENGINE': 'django.db.backends.mysql',        'HOST': '192.168.1.101',        'PORT': <span class="number">3306</span>,        'USER': 'root',        'PASSWORD': '<span class="number">123456</span>',        'NAME': 'test1'    &#125;,    'slave': &#123;        'ENGINE': 'django.db.backends.mysql',        'HOST': '192.168.1.102',        'PORT': <span class="number">3306</span>,        'USER': 'root',        'PASSWORD': '<span class="number">123456</span>',        'NAME': 'test1'    &#125;&#125;DATABASE_ROUTERS = ['pro.utils.MasterSlaveDBRouter']</span><br></pre></td></tr></table></figure><ul><li>编写<strong>db-router</strong></li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MasterSlaveDBRouter</span>:</span>    <span class="string">"""数据库主从读写分离路由"""</span>    <span class="function"><span class="keyword">def</span> <span class="title">db_for_read</span><span class="params">(self, model, **hints)</span>:</span>        <span class="string">"""读数据库"""</span>        <span class="keyword">return</span> <span class="string">"slave"</span>    <span class="function"><span class="keyword">def</span> <span class="title">db_for_write</span><span class="params">(self, model, **hints)</span>:</span>        <span class="string">"""写数据库"""</span>        <span class="keyword">return</span> <span class="string">"default"</span>    <span class="function"><span class="keyword">def</span> <span class="title">allow_relation</span><span class="params">(self, obj1, obj2, **hints)</span>:</span>        <span class="string">"""是否运行关联操作"""</span>        <span class="keyword">return</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure><ul><li>如出现以下错误，修改主库binlog日志格式</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">django.db.utils.InternalError: (1665, 'Cannot <span class="keyword">execute</span> <span class="keyword">statement</span>: impossible <span class="keyword">to</span> write <span class="keyword">to</span> <span class="built_in">binary</span> <span class="keyword">log</span> since BINLOG_FORMAT = <span class="keyword">STATEMENT</span> <span class="keyword">and</span> <span class="keyword">at</span> <span class="keyword">least</span> one <span class="keyword">table</span> uses a <span class="keyword">storage</span> <span class="keyword">engine</span> limited <span class="keyword">to</span> <span class="keyword">row</span>-based logging. <span class="keyword">InnoDB</span> <span class="keyword">is</span> limited <span class="keyword">to</span> <span class="keyword">row</span>-<span class="keyword">logging</span> <span class="keyword">when</span> <span class="keyword">transaction</span> <span class="keyword">isolation</span> <span class="keyword">level</span> <span class="keyword">is</span> <span class="keyword">READ</span> COMMITTED <span class="keyword">or</span> <span class="keyword">READ</span> UNCOMMITTED.<span class="string">')</span></span><br><span class="line"><span class="string">binlog_format=mixed</span></span><br></pre></td></tr></table></figure><h3 id="打开日志用以分析"><a href="#打开日志用以分析" class="headerlink" title="打开日志用以分析"></a>打开日志用以分析</h3><ul><li>可以通过配置<strong>mysql</strong>日志记录，用以查看主从在读写情况下的效果</li></ul><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">general_log=<span class="number">1</span>general_log_file=<span class="regexp">/var/</span>lib<span class="regexp">/mysql/g</span>eneral.log</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Django </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Django </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Mysql主从复制</title>
      <link href="/2018/08/08/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/"/>
      <url>/2018/08/08/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="Mysql主从复制"><a href="#Mysql主从复制" class="headerlink" title="Mysql主从复制"></a>Mysql主从复制</h2><ul><li>什么是<strong>主从复制</strong>？</li></ul><blockquote><p>主从复制至少需要两台服务器，或两个<strong>mysql</strong>服务，可以配置一主多从，多主多从</p><p>建立与某个业务数据库一样的数据库环境，即为主从复制</p><p>一般情况下，主库用以写，而从库用以读</p></blockquote><a id="more"></a><ul><li>为什么要搭建主从复制？<ol><li>构建主从热备，当某天数据库宕机或或数据丢失情况，可以有备份数据库继续工作</li><li>降低IO频次，多库之间可以合理分配读写压力，提高单个数据库服务的数据库访问压力</li><li>隔离读写，在某些锁表情况下，可以使数据库读操作继续进行</li></ol></li></ul><blockquote><p>利用数据库<strong>bin-log</strong>二进制文件，该文件包含有数据库操作的所有SQL语句</p><p>复制该文件至其余数据库服务中并执行即可</p></blockquote><ul><li><p>主从复制过程</p><ol><li><p>当主库具有新数据时，主库会被从库请求，建立线程进行连接，用以传输<strong>binlog</strong>日志</p></li><li><p>从库开启两个线程</p><blockquote><p>A线程：也叫做<strong>IO线程</strong>，连接主库，并请求binlog中的更新记录至从库中，写入至从库的<strong>relaylog</strong>文件中</p><p>B线程：也叫做<strong>SQL线程</strong>，读取<strong>relaylog</strong>文件中的更新操作并执行</p></blockquote></li><li><p>如果，有多个从库同时存在，主库会为每个从库建立一个<strong>binlog</strong>输出线程</p></li></ol></li></ul><p>[<img src="/2018/08/08/主从复制/%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E5%8E%9F%E7%90%86%E8%87%AA%E7%BB%98.png" alt="主从复制原理自绘">]</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> validate_password_policy=<span class="keyword">LOW</span>;<span class="keyword">set</span> <span class="keyword">global</span> validate_password_length=<span class="number">6</span>;</span><br></pre></td></tr></table></figure><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><blockquote><p>此处以一主一丛为例</p></blockquote><ul><li>系统环境<ul><li>主库（master）：192.168.1.100</li><li>从库（slave）：192.168.1.101</li></ul></li></ul><h3 id="主库修改"><a href="#主库修改" class="headerlink" title="主库修改"></a>主库修改</h3><ul><li>主库配置修改</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">server-id = <span class="attribute">1log-bin</span>=mysql-bin # 开启log <span class="attribute">binexpire_logs_days</span>=7 # 日志保存时间</span><br></pre></td></tr></table></figure><blockquote><p><strong>server-id</strong>：</p><p>同步数据中必须包含<strong>server-id</strong>，用于标识该语句最初是从哪个<strong>server</strong>写入</p><p>每个<strong>slave</strong>端只能有一个线程在<strong>master</strong>端连接，如果两个<strong>salve</strong>端的<strong>server-id</strong>一致，一个连接成功之后，前一个连接将会被断开</p><p>主主同步时，避免数据同步陷入死循环</p></blockquote><ul><li>主库创建用户，用以从机连接获取<strong>binlog</strong>日志</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">replication</span> <span class="keyword">slave</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">'master'</span>@<span class="string">'%'</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">'123456'</span>;<span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">all</span> <span class="keyword">privileges</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="keyword">master</span>@<span class="string">'%'</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">"123456"</span>;</span><br></pre></td></tr></table></figure><ul><li>查看master状态</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br></pre></td></tr></table></figure><ul><li>记录上条命令返回的<strong>binlog</strong>文件名，<strong>Position</strong>属性，从机连接的时候要用</li></ul><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+<span class="params">------------------</span>+<span class="params">----------</span>+<span class="params">--------------</span>+<span class="params">------------------</span>+<span class="params">-------------------</span>+| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |+<span class="params">------------------</span>+<span class="params">----------</span>+<span class="params">--------------</span>+<span class="params">------------------</span>+<span class="params">-------------------</span>+| mysql-bin.000001 |      154 |              |                  |                   |+<span class="params">------------------</span>+<span class="params">----------</span>+<span class="params">--------------</span>+<span class="params">------------------</span>+<span class="params">-------------------</span>+1 row in <span class="keyword">set</span> <span class="params">(0.00 sec)</span></span><br></pre></td></tr></table></figure><h3 id="从库修改"><a href="#从库修改" class="headerlink" title="从库修改"></a>从库修改</h3><ul><li>从库配置修改</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server-id</span>=<span class="number">11</span></span><br></pre></td></tr></table></figure><blockquote><p><strong>master</strong>与<strong>slave</strong>端的<strong>server-id</strong>不能一样</p><p><strong>salve</strong>端无需开启<strong>log-bin</strong>功能</p></blockquote><ul><li>从库指定master，执行如下</li></ul><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">change master <span class="keyword">to</span> <span class="attribute">master_host</span>=<span class="string">'192.168.1.100'</span>, <span class="attribute">master_port</span>=3306, <span class="attribute">master_user</span>=<span class="string">'master'</span>, <span class="attribute">master_password</span>=<span class="string">'123456'</span>, <span class="attribute">master_log_file</span>=<span class="string">'mysql-bin.000001'</span>, <span class="attribute">master_log_pos</span>=154;</span><br></pre></td></tr></table></figure><ul><li>启动从机</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">start</span> <span class="keyword">slave</span>;</span><br></pre></td></tr></table></figure><h3 id="同步特定的库"><a href="#同步特定的库" class="headerlink" title="同步特定的库"></a>同步特定的库</h3><h4 id="主机处配置"><a href="#主机处配置" class="headerlink" title="主机处配置"></a>主机处配置</h4><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">binlog-do-db</span>=xxxx   # 二进制日志记录的数据库<span class="attribute">binlog-ignore-db</span>=xxxx # 二进制日志中忽略数据库</span><br></pre></td></tr></table></figure><h4 id="从机处配置"><a href="#从机处配置" class="headerlink" title="从机处配置"></a>从机处配置</h4><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">replicate-<span class="keyword">do</span>-<span class="keyword">db</span>    # 设定需要复制的数据库replicate-ignore-<span class="keyword">db</span> # 设定需要忽略的复制数据库replicate-<span class="keyword">do</span>-<span class="keyword">table</span>  # 设定需要复制的表replicate-ignore-<span class="keyword">table</span> # 设定需要忽略的复制表replicate-wild-<span class="keyword">do</span>-<span class="keyword">table</span> # 同replication-<span class="keyword">do</span>-<span class="keyword">table</span>功能一样，但是可以通配符replicate-wild-ignore-<span class="keyword">table</span> # 同replication-ignore-<span class="keyword">table</span>功能一样，但是可以加通配符</span><br></pre></td></tr></table></figure><h3 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h3><ul><li><strong>mysql</strong>-&gt;<strong>mariadb</strong>版本问题</li></ul><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Last_IO_Error: Got fatal <span class="keyword">error</span> <span class="number">1236</span> <span class="keyword">from</span> master when reading data <span class="keyword">from</span> binary <span class="built_in">log</span>: 'Client requested master <span class="keyword">to</span> start replication <span class="keyword">from</span> position &gt; <span class="built_in">file</span> size'</span><br></pre></td></tr></table></figure><blockquote><p>从<strong>MySQL5.6</strong>开始引入了<strong>binlog_checksum</strong>全局变量，即<strong>MySQL</strong>会将<strong>event</strong>的<strong>CRC32</strong>校验值也写入<strong>binlog</strong>，显然<strong>MariaDB</strong>在分析日志的时候不会考虑该信息，导致解析出错</p></blockquote><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">'%binlog%'</span>;</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> binlog_checksum=<span class="keyword">NONE</span>;</span><br></pre></td></tr></table></figure><ul><li><p>当使用命令show slave status\G;  查看从机与主机的连接状态时，本应该这样：</p><p>​    Slave_IO_Running: Yes</p><p>​    Slave_SQL_Running: Yes    </p><p>​     但是出现了这种情况：</p><p><img src="/2018/08/08/主从复制/%E9%94%99%E8%AF%AF.png" alt="image"></p></li><li><p>处理办法：</p><ul><li>重置mysql数据库 ：systemctl restart mariadb.service</li><li>由此我想到了一个远古的传说：当改变应用程序的配置文件后，先重新启动以保证配置文件生效！！！谨记</li></ul></li></ul>]]></content>
      
      
      <categories>
          
          <category> mysql </category>
          
      </categories>
      
      
        <tags>
            
            <tag> mysql </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
